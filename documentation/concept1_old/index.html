
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://johanneslks.github.io/Thesis/documentation/concept1_old/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>Unsupervised Multi-Layer Anomaly Detection and Attack Chain Extraction in Unstructured Honeypot Logs - Honeypot Anomaly Detection</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#unsupervised-multi-layer-anomaly-detection-and-attack-chain-extraction-in-unstructured-honeypot-logs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Honeypot Anomaly Detection" class="md-header__button md-logo" aria-label="Honeypot Anomaly Detection" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Honeypot Anomaly Detection
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Unsupervised Multi-Layer Anomaly Detection and Attack Chain Extraction in Unstructured Honeypot Logs
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../" class="md-tabs__link">
          
  
  
  Documentation

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Honeypot Anomaly Detection" class="md-nav__button md-logo" aria-label="Honeypot Anomaly Detection" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Honeypot Anomaly Detection
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Documentation
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Documentation
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../relatedWork/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Related Work
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../journals/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Journals
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../thoughts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Thoughts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../concept1/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concept I
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1-related-work-and-positioning" class="md-nav__link">
    <span class="md-ellipsis">
      1. Related Work and Positioning
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-introduction" class="md-nav__link">
    <span class="md-ellipsis">
      2. Introduction
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-proposed-architecture-enhanced-conceptual-design" class="md-nav__link">
    <span class="md-ellipsis">
      3. Proposed Architecture: Enhanced Conceptual Design
    </span>
  </a>
  
    <nav class="md-nav" aria-label="3. Proposed Architecture: Enhanced Conceptual Design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#31-key-innovations" class="md-nav__link">
    <span class="md-ellipsis">
      3.1 Key Innovations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-updated-architecture-diagram-conceptual-overview" class="md-nav__link">
    <span class="md-ellipsis">
      3.2 Updated Architecture Diagram (Conceptual Overview)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-mathematical-background" class="md-nav__link">
    <span class="md-ellipsis">
      4. Mathematical Background
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4. Mathematical Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#41-problem-setup" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Problem Setup
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-cross-session-anomaly-cohesion-score-csacs" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Cross-Session Anomaly Cohesion Score (CSACS)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-optimization-objective" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Optimization Objective
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-hypothetical-stability-theorem-conceptual-proposal" class="md-nav__link">
    <span class="md-ellipsis">
      4.4 Hypothetical Stability Theorem (Conceptual Proposal)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-data-strategy-implementation-and-evaluation-plan" class="md-nav__link">
    <span class="md-ellipsis">
      5. Data Strategy, Implementation, and Evaluation Plan
    </span>
  </a>
  
    <nav class="md-nav" aria-label="5. Data Strategy, Implementation, and Evaluation Plan">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#51-datasets" class="md-nav__link">
    <span class="md-ellipsis">
      5.1 Datasets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-ablation-studies-and-comparative-experiments" class="md-nav__link">
    <span class="md-ellipsis">
      5.2 Ablation Studies and Comparative Experiments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-real-time-constraints-and-overhead-mitigation" class="md-nav__link">
    <span class="md-ellipsis">
      5.3 Real-Time Constraints and Overhead Mitigation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#54-explainability-demonstration" class="md-nav__link">
    <span class="md-ellipsis">
      5.4 Explainability Demonstration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="unsupervised-multi-layer-anomaly-detection-and-attack-chain-extraction-in-unstructured-honeypot-logs">Unsupervised Multi-Layer Anomaly Detection and Attack Chain Extraction in Unstructured Honeypot Logs</h1>
<p><em>A Hybrid Deep Learning Framework for Modeling Complex Attacker Behavior on Unlabeled Production Data</em></p>
<hr />
<p>This concept is created with help from Generative AI (ChatGpt o1 + 4o)</p>
<hr />
<h2 id="1-related-work-and-positioning">1. Related Work and Positioning</h2>
<p>This framework builds upon and addresses gaps identified in state-of-the-art research, including:</p>
<ul>
<li><strong>An Unsupervised Deep Learning Model for Early Network Traffic Anomaly Detection (2020)</strong>: CNN combined with autoencoders for early anomaly detection on IoT traffic, using only the first bytes of flows for fast detection.  </li>
<li><strong>Anomaly Detection from Log Files Using Unsupervised Deep Learning (2020)</strong>: LSTM autoencoder applied to raw, unstructured log data without preprocessing; relevant for modeling temporal rarity signals.  </li>
<li><strong>DeepLog (2017)</strong>: LSTM-based modeling of structured system log sequences, with incremental updates but limited to single-session and structured data.  </li>
<li><strong>AutoLog (2021)</strong>: Template-free deep autoencoder using entropy scoring, effective on heterogeneous system logs, but lacking relational modeling across sessions.  </li>
<li><strong>Raw Packet Data Ingestion with Transformers (2023)</strong>: Byte-level transformer ingestion of raw packet data; demonstrates feasibility but faces large infrastructure demands.  </li>
<li><strong>Unsupervised Machine Learning Techniques for Network Intrusion Detection (2020)</strong>: Comparison of PCA, Isolation Forest, One-Class SVM, and autoencoders; highlights autoencoders' superiority for zero-day detection and real-time efficiency.  </li>
<li><strong>A Deep Learning Approach to Network Intrusion Detection (2017)</strong>: Stacked non-symmetric autoencoders with random forest classifiers; foundational for hybrid feature extraction and classification.  </li>
<li><strong>An LSTM-Based Deep Learning Approach for Packet-Level Detection (2020)</strong>: Embedding of packet header fields for sequence-based anomaly detection, pointing out limitations in generalizing to payloads.  </li>
<li><strong>UNADA (2015)</strong>: Clustering-based unsupervised anomaly detection in honeypot traffic with automated signature generation; limited to NetFlow data.  </li>
<li><strong>FedNIDS (2025)</strong>: Federated supervised learning on packet data; excellent scalability, but lacks unsupervised adaptability for unknown attacks.  </li>
<li><strong>DeepFed (2023)</strong>: Federated, unsupervised deep anomaly detection across unlabeled data streams, relevant for future decentralized security models.  </li>
<li><strong>Graph Neural Networks for Anomaly Detection in Dynamic Graphs (2022)</strong>: Reviews scalability strategies and temporal GNN frameworks applicable to dynamic honeypot graph construction.  </li>
<li><strong>Online and Adaptive Graph Construction for Anomaly Detection (2022)</strong>: Introduces dynamic graph edge adaptation mechanisms based on anomaly scores and time decay.  </li>
<li><strong>Explainable AI for Anomaly Detection in Cybersecurity (2023)</strong>: Provides guidance on integrating GNN explainability techniques like GNNExplainer and interpretability for security analysts.</li>
</ul>
<hr />
<h2 id="2-introduction">2. Introduction</h2>
<p>The detection of anomalies and the reconstruction of attack chains in unstructured honeypot logs represent a complex challenge. Existing literature provides valuable inspiration but also exposes clear gaps—particularly in handling massive, unlabeled datasets and detecting multi-session or long-tail attacks. This document proposes a critically designed architecture and theoretical framework that leverages the strengths and addresses the weaknesses identified across recent state-of-the-art research.</p>
<p>Given the large-scale nature of production honeypot data, this paper primarily focuses on an unlabeled 500 GB dataset provided by the BSI (German Federal Office for Information Security). Its considerable size and lack of any explicit ground truth motivate a fully unsupervised approach. For further validation and partial ground-truth checks, classical intrusion datasets such as <strong>KDD Cup 99</strong> and <strong>NSL-KDD</strong> will be leveraged. This combination enables comprehensive benchmarking: the BSI dataset tests scalability and real-world complexity, while the smaller labeled sets confirm detection accuracy on known attack classes.</p>
<hr />
<h2 id="3-proposed-architecture-enhanced-conceptual-design">3. Proposed Architecture: Enhanced Conceptual Design</h2>
<h3 id="31-key-innovations">3.1 Key Innovations</h3>
<p>(1) <strong>Line-Level Modeling</strong><br />
Use a lightweight denoising sequence autoencoder for byte-level embeddings of log lines. This autoencoder simultaneously provides a line embedding vector (from the bottleneck layer) and a reconstruction error as an anomaly score.</p>
<p>(2) <strong>Session-Level Modeling</strong><br />
Deploy a hybrid Transformer-LSTM module with temporal attention to capture both local (sequence-based) and global (contextual) session behavior. This layer aggregates line embeddings into a coherent session representation, accounting for potential long-range dependencies and ordering.</p>
<p>(3) <strong>Temporal Relationship Modeling</strong><br />
Construct dynamic session graphs in which edges reflect semantic distance and temporal adjacency, decaying exponentially over time. This approach helps identify how different sessions are interlinked, uncovering multi-session attack sequences or correlated anomalies.</p>
<p>(4) <strong>Graph Neural Network Layer</strong><br />
Integrate a scalable GNN using subgraph sampling techniques (e.g., GraphSAGE or Cluster-GCN) to handle large, evolving graphs without overwhelming memory. This layer consolidates session embeddings and uncovers global patterns indicative of distributed or advanced persistent threats (APTs).</p>
<p>(5) <strong>Fusion Layer</strong><br />
Design an attention-based fusion mechanism that combines:  </p>
<ul>
<li><strong>Line-level anomaly scores</strong> (reconstruction error from the autoencoder),  </li>
<li><strong>Session-level anomaly indicators</strong>,  </li>
<li><strong>GNN-based cluster embeddings</strong>.  </li>
</ul>
<p>By weighting these factors, the fusion layer seeks a comprehensive anomaly indicator reflective of local outliers and global relational structure.</p>
<p>(6) <strong>Improved Attack Chain Extraction</strong><br />
Implement a two-stage process—first, coarse temporal clustering (via DBSCAN on timestamp embeddings) to group sessions that lie close in time, followed by fine-grained community detection (e.g., Leiden algorithm) to identify subgroups with high anomaly cohesion. This helps reconstruct potentially large, multi-step attack chains spanning many sessions.</p>
<p>(7) <strong>Explainability</strong><br />
Incorporate GNNExplainer for subgraph-level interpretability and heatmaps showing the most significant lines or sessions in an anomalous cluster. By mapping the contributing features back to raw log lines, security analysts can trace suspicious activity with minimal manual overhead.</p>
<h3 id="32-updated-architecture-diagram-conceptual-overview">3.2 Updated Architecture Diagram (Conceptual Overview)</h3>
<pre class="mermaid"><code>graph TD
  Input["Unlabeled Honeypot Logs (500 GB BSI)"]
  Input --&gt; Autoencoder["Lightweight Sequence Autoencoder"]

  Autoencoder --&gt; LineEmbeddings["Line Embeddings (Bottleneck Layer)"]
  Autoencoder --&gt; LineAnomaly["Line-Level Anomaly Scores (Reconstruction Error)"]

  LineEmbeddings --&gt; SessionModel["Session-Level Hybrid Transformer-LSTM"]

  SessionModel --&gt; SessionEmbeddings["Session Embeddings"]
  SessionEmbeddings --&gt; TemporalGraph["Dynamic Temporal Session Graph"]
  TemporalGraph --&gt; GNN["Scalable GNN with Subgraph Sampling"]

  GNN --&gt; Fusion["Attention-Based Fusion Layer"]
  LineAnomaly --&gt; Fusion

  Fusion --&gt; AttackChains["Two-Stage Attack Chain Extraction"]
  AttackChains --&gt; Output["Attack Chain Reports &amp; Visualizations"]
  Fusion --&gt;|Feedback Loop| TemporalGraph
  AttackChains --&gt;|Continuous Update| SessionModel</code></pre>
<hr />
<h2 id="4-mathematical-background">4. Mathematical Background</h2>
<h3 id="41-problem-setup">4.1 Problem Setup</h3>
<ul>
<li><strong>Honeypot Log Lines</strong><br />
  $$
    L = {l_1, l_2, \dots, l_n}
  $$  </li>
<li><strong>Grouped into Sessions</strong><br />
  $$
    S = {s_1, s_2, \dots, s_m}
  $$  </li>
<li><strong>Per-Line Embeddings</strong><br />
  $$
    e_{l_i} \in \mathbb{R}^d
  $$<br />
  Each log line is mapped to a continuous vector representation.  </li>
<li><strong>Session Embeddings</strong><br />
  Derived from the final state of the Transformer-LSTM stack:<br />
  $$
    e_{s_i} = \text{TransformerLSTM}(s_i)
  $$</li>
</ul>
<h3 id="42-cross-session-anomaly-cohesion-score-csacs">4.2 Cross-Session Anomaly Cohesion Score (CSACS)</h3>
<p>To quantify how anomalous and tightly coupled a community <span class="arithmatex">\( C \)</span> of sessions is, we propose:</p>
<div class="arithmatex">\[
  CSACS(C) = \frac{ \sum_{(s_i, s_j) \in E_C} \left( \lambda_1 \cdot \frac{1}{D(s_i, s_j) + \epsilon} + \lambda_2 \cdot \frac{1}{T(s_i, s_j) + \delta} \right) \cdot \min(A(s_i), A(s_j)) }{ |E_C| }
\]</div>
<p><strong>Where</strong>:</p>
<ul>
<li><span class="arithmatex">\( E_C \)</span>: set of edges among sessions in community <span class="arithmatex">\( C \)</span>  </li>
<li><span class="arithmatex">\( D(s_i, s_j) \)</span>: distance between session embeddings <span class="arithmatex">\( e_{s_i} \)</span> and <span class="arithmatex">\( e_{s_j} \)</span>  </li>
<li><span class="arithmatex">\( T(s_i, s_j) \)</span>: temporal gap between sessions  </li>
<li><span class="arithmatex">\( A(s_i) \)</span>: anomaly score of session <span class="arithmatex">\( s_i \)</span>  </li>
<li><span class="arithmatex">\( \lambda_1, \lambda_2 \)</span>: weighting parameters  </li>
<li><span class="arithmatex">\( \epsilon, \delta \)</span>: small constants for numerical stability  </li>
</ul>
<h3 id="43-optimization-objective">4.3 Optimization Objective</h3>
<p>$$
  \max_{C} \; CSACS(C) \;-\; \gamma \cdot |C|
$$
Balancing cluster compactness and size through a regularization term <span class="arithmatex">\(\gamma\)</span>.</p>
<h3 id="44-hypothetical-stability-theorem-conceptual-proposal">4.4 Hypothetical Stability Theorem (Conceptual Proposal)</h3>
<blockquote>
<p><strong>Theorem:</strong> Under Gaussian noise and uniform temporal distribution assumptions, the probability that a random cluster exceeds threshold <span class="arithmatex">\(\theta\)</span> decays exponentially with the number of edges:<br />
$$
  P(CSACS(C) \geq \theta) \;\leq\; \exp\Bigl(-\alpha \cdot |E_C| \cdot \theta\Bigr),
$$<br />
where <span class="arithmatex">\(\alpha &gt; 0\)</span> depends on the noise variance.<br />
<strong>Note:</strong> A full proof is out of scope for this paper, but future work will involve both theoretical and empirical analysis to validate or refine this statement.</p>
</blockquote>
<hr />
<h2 id="5-data-strategy-implementation-and-evaluation-plan">5. Data Strategy, Implementation, and Evaluation Plan</h2>
<h3 id="51-datasets">5.1 Datasets</h3>
<ol>
<li>
<p><strong>Unlabeled 500 GB BSI Honeypot Dataset</strong>  </p>
<ul>
<li>Large-scale, real-world, unstructured data.  </li>
<li>Ideal for testing scalability and unsupervised capabilities on production-level volumes.  </li>
<li>We will measure detection coverage, throughput (logs/sec), and resource usage (CPU/GPU memory) in near real-time pipelines.</li>
</ul>
</li>
<li>
<p><strong>KDD Cup 99 / NSL-KDD</strong>  </p>
<ul>
<li>Classic labeled intrusion datasets, albeit somewhat dated.  </li>
<li>Useful for establishing performance baselines (Precision, Recall, F1).  </li>
<li>Provides partial ground truth and confirms whether the system can detect well-known attacks.</li>
</ul>
</li>
</ol>
<h3 id="52-ablation-studies-and-comparative-experiments">5.2 Ablation Studies and Comparative Experiments</h3>
<p>We propose <strong>five</strong> key ablations to rigorously test each major architectural component:</p>
<ol>
<li>
<p><strong>Autoencoder vs. Transformer (historical reference)</strong>  </p>
<ul>
<li><strong>Hypothesis:</strong> Although Transformer embeddings could be more expressive, a well-trained autoencoder provides a robust and scalable alternative with anomaly scoring capability.  </li>
<li><strong>Metrics:</strong> Reconstruction error, classification metrics (where labels exist), ingestion throughput.</li>
</ul>
</li>
<li>
<p><strong>Full Session Model vs. No Session Model</strong>  </p>
<ul>
<li><strong>Setup:</strong> Compare a pipeline that (a) aggregates log lines into sessions vs. (b) treats every line independently before the GNN.  </li>
<li><strong>Aim:</strong> Check if ignoring session context severely diminishes anomaly detection for multi-step attacks.</li>
</ul>
</li>
<li>
<p><strong>Static vs. Dynamic Graph Construction</strong>  </p>
<ul>
<li><strong>Variant A:</strong> Build a static graph for a fixed time window.  </li>
<li><strong>Variant B:</strong> Continuously update edges with an exponential time decay.  </li>
<li><strong>Goal:</strong> Evaluate whether dynamic adjacency provides better chain detection for persistent or slow-moving attacks.</li>
</ul>
</li>
<li>
<p><strong>GNN vs. Simpler Aggregator</strong>  </p>
<ul>
<li><strong>Comparison:</strong> Replace the GNN with a basic aggregator (e.g., an MLP on session embeddings or a clustering method like k-Means).  </li>
<li><strong>Question:</strong> Is the complexity of a GNN justified by significantly better correlation of anomalies across sessions?</li>
</ul>
</li>
<li>
<p><strong>Fusion vs. Single Anomaly Score</strong>  </p>
<ul>
<li><strong>Approach:</strong> Compare using a single anomaly score (e.g., from the session model only) vs. combining line-level, session-level, and GNN-based signals in the fusion layer.  </li>
<li><strong>Objective:</strong> Demonstrate whether multi-level fusion substantially improves detection robustness and reduces false positives.</li>
</ul>
</li>
</ol>
<h3 id="53-real-time-constraints-and-overhead-mitigation">5.3 Real-Time Constraints and Overhead Mitigation</h3>
<ul>
<li><strong>Subgraph Sampling &amp; Mini-batch Training</strong>: Techniques like GraphSAGE or Cluster-GCN prevent memory overflow by processing only portions of the graph at each step.  </li>
<li><strong>Fallback Autoencoder</strong>: Serves as both feature generator and anomaly scorer with minimal overhead.  </li>
<li><strong>Asynchronous Pipelines &amp; Approximate Queries</strong>: Use approximate nearest neighbor (ANN) for faster edge construction among sessions and decouple embedding computation from graph updates for better parallelization.</li>
</ul>
<h3 id="54-explainability-demonstration">5.4 Explainability Demonstration</h3>
<ul>
<li><strong>Case Studies on BSI Dataset</strong>: Highlight suspicious clusters identified by the system, visualizing subgraphs with GNNExplainer.  </li>
<li><strong>Line-Level Heatmaps</strong>: Provide interpretability for local anomalies, showing which tokens or segments in a log line contributed most to the anomaly score.  </li>
<li><strong>Comparison to Baselines</strong>: Methods like Isolation Forest or simpler autoencoders will be used to illustrate how deeper embedding and graph-based context capture more complex attack patterns.</li>
</ul>
<hr />












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "search.highlight"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
        <script src="https://unpkg.com/mermaid@10/dist/mermaid.min.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>